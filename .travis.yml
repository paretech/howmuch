# https://docs.travis-ci.com/user/reference/windows
# https://travis-ci.community/t/current-known-issues-please-read-this-before-posting-a-new-topic/264/10
# https://docs.travis-ci.com/user/best-practices-security
# https://ruszkow.ski/posts/2019-10-21-travis-+-pyinstaller-+-github-releases/
os: windows
language: bash
before_install:
  # https://docs.travis-ci.com/user/languages/python/
  # https://blog.travis-ci.com/2019-08-07-extensive-python-testing-on-travis-ci
  # Windows doesn't support python out of the box
  - choco install python --version=3.8
  - python -m pip install --upgrade pip
# Could not get gitbash to update env variables. Hard coding python path
env: PATH=/c/Python38:/c/Python38/Scripts:$PATH
install:
  - pip install -r requirements.txt
script:
  - pyinstaller "showme.spec"
  - cat ./build/showme/warn-showme.txt
  
  # before_deploy:
    #   - pyinstaller "showme.spec"
deploy:
  # https://docs.travis-ci.com/user/deployment/releases/
  provider: releases
  api_key:
    secure: MDXGoRSjEEAWEaHKbQbvzTy4DsPekcN1yrUvq93XKA/ixpp8YLXskzclCZPoUt88AIFuoEky5ozwGLMl9N6m6gjsCWcwXpaGC+Y7uFbUpR2B0IemQ2lE811IQBhQtaHF4r4q3auTfpsApnUexRS43UDa5hVRIByS9tnhOIBoZJC0Rbt2qjxYcxhiK8WBC5obkDxto2NLYQYFocQFGUjZhR+RjjeG5RRGOskg3kbKZyZ4TlJUw0wqX2lAjTHx0uqWdssiqWK0gPZNWcku6JzdRfNYLwOZazqbbDQ9qzA+PWpBbZViJ/wGHlmqJdS/r6Vz5OxI1AohvdkrUpHYyrkirLF/bolM3A7YsxcmDPDdF8ZHtMFsVhLvOzua/8+laAO7yEI2ijYgvGcRNICFF1hZ1ELcHH8ptuReV4nOKCoLtfmT83qKTCbsDK9Clev793bs6wvQ6M80WoogAd3O3OTic9UOD7kY09P4hUbq1nqOo2xEjRDnRmhtAe3ERkmeIgZFybZvndgvk2kzf8jDrP0zbMKaZP8bzSj/I5AtOVBDOoAw4Ue63670gL/GIYTFQE+frAAhaRiDR7gV2kMpZ9OfCEDyY4JaAZlLOAEmDckz9d5d1e7Bi86G5xnmyYxthbT4fWpHucVcMvEjCTKbNspQzdaZ+/Fq4HnXYmsenOJu7RY=
  file_glob: true
  file: dist/*.exe
  skip_cleanup: 'true'
  on:
    tags: true
    repo: paretech/showme
    # branch: ci_build
  # https://packaging.python.org/guides/single-sourcing-package-version/
  # https://github.com/ncoghlan/python-packaging-user-guide/blob/master/source/guides/single-sourcing-package-version.rst
  name: $TRAVIS_TAG
      